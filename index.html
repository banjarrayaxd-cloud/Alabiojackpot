<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ALABIO Pangkalan Sari Slot</title>
<style>
body{
  margin:0;
  background:radial-gradient(circle,#0f2027,#203a43,#2c5364);
  font-family:Arial;
  color:white;
  text-align:center;
  overflow:hidden;
}
h1{margin:10px;color:gold;text-shadow:0 0 15px gold;}
.topbar{display:flex;justify-content:space-around;font-size:14px;padding:8px;}
.slot{display:flex;justify-content:center;margin:20px auto;}
.reel{width:70px;height:280px;overflow:hidden;border:2px solid gold;border-radius:10px;margin:0 5px;background:#111;position:relative;}
.reel-inner{position:absolute;width:100%;}
.symbol{height:70px;display:flex;align-items:center;justify-content:center;font-size:26px;background:linear-gradient(#ffd700,#b8860b);color:black;border-bottom:1px solid #333;}
.controls button{padding:8px 15px;margin:5px;border:none;border-radius:8px;cursor:pointer;}
.spin{background:red;color:white;font-size:18px;}
.bigwin{position:fixed;top:40%;left:50%;transform:translate(-50%,-50%);font-size:45px;font-weight:bold;color:gold;display:none;text-shadow:0 0 20px gold;}
.bonus-mode{background: linear-gradient(45deg, gold, orange);}
#login-form{margin-top:50px;}
#login-form input{padding:8px;margin:5px;border-radius:5px;border:none;font-size:16px;}
#login-form button{padding:8px 15px;margin:5px;border:none;border-radius:8px;background:#ff6600;color:white;cursor:pointer;}
</style>
<!-- FIREBASE CDN -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
</head>
<body>

<h1>ðŸŽ° ALABIO Pangkalan Sari Slot</h1>

<!-- LOGIN FORM -->
<div id="login-form">
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <br>
  <button onclick="registerUser()">Register</button>
  <button onclick="loginUser()">Login</button>
</div>

<!-- SLOT GAME -->
<div id="gameBox" style="display:none;">
  <div class="topbar">
    <div>Saldo: <span id="balance">0</span></div>
    <div>Bet: <span id="bet">1000</span></div>
  </div>

  <div class="slot" id="slot"></div>

  <div class="controls">
    <div style="margin-bottom:10px;">
      <button onclick="setBet(1000)">1000</button>
      <button onclick="setBet(2000)">2000</button>
      <button onclick="setBet(5000)">5000</button>
      <button onclick="setBet(10000)">10000</button>
    </div>
    <button class="spin" onclick="spin()">SPIN</button>
  </div>

  <div class="bigwin" id="bigwin">ðŸ”¥ BIG WIN ðŸ”¥</div>
</div>

<script>
// ===== FIREBASE CONFIG =====
const firebaseConfig = {
  apiKey: "AIzaSyClAxn0V3k-0taY76A4HN1qS4_o483ba8U",
  authDomain: "alabio-slot.firebaseapp.com",
  projectId: "alabio-slot",
  storageBucket: "alabio-slot.firebasestorage.app",
  messagingSenderId: "418392865685",
  appId: "1:418392865685:web:50a233aad7e8d32712949c"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// ====== SLOT VARIABLES ======
const symbols=["ðŸ€„","ðŸ€…","ðŸ€†","ðŸ€‡","ðŸ€ˆ","ðŸ€‰","ðŸ’Ž"];
let balance = 0;
let bet = 1000;
let freeSpins = 0;
let bonusMode = false;

const slot=document.getElementById("slot");
const balanceEl=document.getElementById("balance");
const betEl=document.getElementById("bet");
const bigwinEl=document.getElementById("bigwin");
const loginForm = document.getElementById("login-form");
const gameBox = document.getElementById("gameBox");

// ===== LOGIN/REGISTER =====
function registerUser(){
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  auth.createUserWithEmailAndPassword(email,password)
    .then((cred)=>{
      alert("Register sukses: "+cred.user.email);
      initUser(cred.user);
    })
    .catch(err=>alert(err.message));
}

function loginUser(){
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  auth.signInWithEmailAndPassword(email,password)
    .then((cred)=>{
      alert("Login sukses: "+cred.user.email);
      initUser(cred.user);
    })
    .catch(err=>alert(err.message));
}

// ===== INIT USER =====
function initUser(user){
  loginForm.style.display="none";
  gameBox.style.display="block";
  const userDoc = db.collection("users").doc(user.uid);
  userDoc.get().then(doc=>{
    if(doc.exists){
      balance = doc.data().balance;
    }else{
      userDoc.set({balance:1000000});
      balance = 1000000;
    }
    updateUI();
  });
}

// ===== UI UPDATE =====
function updateUI(){
  balanceEl.innerText = "Rp "+balance.toLocaleString("id-ID");
  betEl.innerText = "Rp "+bet.toLocaleString("id-ID");
}

// ===== BET =====
function setBet(amount){ bet=amount; updateUI(); }

// ===== SLOT FUNCTIONS =====
function randomSymbol(){ return symbols[Math.floor(Math.random()*symbols.length)]; }

function createReels(){
  slot.innerHTML="";
  for(let i=0;i<5;i++){
    const reel=document.createElement("div");
    reel.className="reel";
    const inner=document.createElement("div");
    inner.className="reel-inner";
    for(let j=0;j<10;j++){
      const sym=document.createElement("div");
      sym.className="symbol";
      sym.innerText=randomSymbol();
      inner.appendChild(sym);
    }
    reel.appendChild(inner);
    slot.appendChild(reel);
  }
}

function spin(){
  if(balance<bet && freeSpins===0) return alert("Saldo habis!");
  if(freeSpins===0) balance-=bet; else {freeSpins--; alert("ðŸŽ FREE SPIN! Sisa: "+freeSpins);}
  updateUI();

  const reels=document.querySelectorAll(".reel-inner");
  let crownCount=0;

  reels.forEach((reel,index)=>{
    reel.style.transition="none"; reel.style.top="0px";
    setTimeout(()=>{
      reel.style.transition="top 1s ease-out"; reel.style.top="-350px";
    },index*200);
    setTimeout(()=>{
      reel.style.transition="none"; reel.style.top="0px"; reel.innerHTML="";
      for(let j=0;j<10;j++){
        const sym=document.createElement("div");
        sym.className="symbol";
        sym.innerText=randomSymbol();
        reel.appendChild(sym);
        if(sym.innerText==="ðŸ’Ž") crownCount++;
      }
    },1200+index*200);
  });

  setTimeout(()=>{
    // FREE SPIN MODE
    if(crownCount>=3){ freeSpins+=5; bonusMode=true; document.body.classList.add("bonus-mode"); alert("ðŸ”¥ FREE SPIN MODE AKTIF! 5 SPIN + WIN x10"); }
    let winChance = Math.random();
    if(winChance>0.7){
      let multiplier = bonusMode?10:5;
      let winAmount = bet*multiplier;
      balance+=winAmount;
      bigwinEl.style.display="block";
      setTimeout(()=>bigwinEl.style.display="none",1500);
      updateUI();
    }
    if(freeSpins===0){ bonusMode=false; document.body.classList.remove("bonus-mode"); }
    // SIMPAN BALANCE KE FIRESTORE
    const user = auth.currentUser;
    if(user) db.collection("users").doc(user.uid).set({balance:balance});
  },1800);
}

createReels();
updateUI();

</script>

</body>
</html>
