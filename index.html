<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mahjong Style Slot Ultimate</title>
<style>
body{
  margin:0;
  background:radial-gradient(circle,#1a2a6c,#16222A);
  font-family:Arial;
  color:white;
  text-align:center;
  overflow:hidden;
}

h1{
  margin:10px;
  color:gold;
  text-shadow:0 0 10px gold;
}

.topbar{
  display:flex;
  justify-content:space-around;
  font-size:14px;
  padding:8px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(5,70px);
  grid-template-rows:repeat(4,70px);
  gap:6px;
  justify-content:center;
  margin:15px auto;
}

.cell{
  background:linear-gradient(#ffd700,#b8860b);
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  color:black;
  transition:0.3s;
  animation:drop 0.3s ease;
}

@keyframes drop{
  from{transform:translateY(-40px);opacity:0;}
  to{transform:translateY(0);opacity:1;}
}

.win{
  box-shadow:0 0 15px lime;
  transform:scale(1.2);
}

.scatter{
  background:orange !important;
}

button{
  padding:8px 15px;
  margin:5px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

.spin{
  background:red;
  color:white;
  font-size:18px;
}

.bigwin{
  position:fixed;
  top:40%;
  left:50%;
  transform:translate(-50%,-50%);
  font-size:45px;
  font-weight:bold;
  color:gold;
  display:none;
  text-shadow:0 0 20px gold;
}

.coin{
  position:fixed;
  top:-20px;
  font-size:20px;
  animation:fall 2s linear forwards;
}

@keyframes fall{
  to{transform:translateY(100vh);opacity:0;}
}
</style>
</head>
<body>

<h1>ðŸŽ° Mahjong Slot Ultimate (Demo)</h1>

<div class="topbar">
  <div>Saldo: <span id="balance">1000</span></div>
  <div>Bet: <span id="bet">10</span></div>
  <div>Multi: x<span id="multi">1</span></div>
  <div>Free: <span id="free">0</span></div>
</div>

<div class="grid" id="grid"></div>

<div>
  <button onclick="changeBet(-10)">- Bet</button>
  <button onclick="changeBet(10)">+ Bet</button>
  <button onclick="toggleTurbo()">Turbo</button>
  <button class="spin" onclick="spin()">SPIN</button>
</div>

<div class="bigwin" id="bigwin">ðŸ”¥ MEGA WIN ðŸ”¥</div>

<audio id="spinSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<audio id="winSound" src="https://actions.google.com/sounds/v1/cartoon/concussive_hit_guitar_boing.ogg"></audio>

<script>
const symbols=["ðŸ€„","ðŸ€…","ðŸ€†","ðŸ€‡","ðŸ€ˆ","ðŸ€‰"];
const scatterSymbol="ðŸ’Ž";

let balance=1000;
let bet=10;
let multiplier=1;
let freeSpin=0;
let turbo=false;

const gridEl=document.getElementById("grid");
const balanceEl=document.getElementById("balance");
const betEl=document.getElementById("bet");
const multiEl=document.getElementById("multi");
const freeEl=document.getElementById("free");
const bigwinEl=document.getElementById("bigwin");
const spinSound=document.getElementById("spinSound");
const winSound=document.getElementById("winSound");

function updateUI(){
  balanceEl.innerText=balance;
  betEl.innerText=bet;
  multiEl.innerText=multiplier;
  freeEl.innerText=freeSpin;
}

function randomSymbol(){
  if(Math.random()<0.1) return scatterSymbol;
  return symbols[Math.floor(Math.random()*symbols.length)];
}

function createGrid(){
  gridEl.innerHTML="";
  for(let i=0;i<20;i++){
    const div=document.createElement("div");
    div.classList.add("cell");
    div.innerText=randomSymbol();
    gridEl.appendChild(div);
  }
}

function spin(){
  if(balance<bet && freeSpin==0) return alert("Saldo habis!");

  spinSound.play();

  if(freeSpin>0) freeSpin--;
  else balance-=bet;

  multiplier=1;
  createGrid();
  setTimeout(checkResult, turbo?100:400);
  updateUI();
}

function checkResult(){
  const cells=document.querySelectorAll(".cell");
  let map={}, scatterCount=0, totalWin=0;

  cells.forEach(cell=>{
    map[cell.innerText]=(map[cell.innerText]||0)+1;
    if(cell.innerText==scatterSymbol){
      cell.classList.add("scatter");
      scatterCount++;
    }
  });

  if(scatterCount>=3) freeSpin+=5;

  for(let key in map){
    if(key!=scatterSymbol && map[key]>=4){
      cells.forEach(cell=>{
        if(cell.innerText==key){
          cell.classList.add("win");
        }
      });
      totalWin+=bet*multiplier*(map[key]/4);
      multiplier++;
    }
  }

  if(totalWin>0){
    winSound.play();
    balance+=Math.floor(totalWin);

    if(totalWin>bet*5){
      showBigWin();
      dropCoins();
      navigator.vibrate?.(300);
    }

    updateUI();
    setTimeout(cascade, turbo?100:500);
  }
}

function cascade(){
  const cells=document.querySelectorAll(".cell");
  cells.forEach(cell=>{
    if(cell.classList.contains("win")){
      cell.classList.remove("win");
      cell.innerText=randomSymbol();
    }
  });
  setTimeout(checkResult, turbo?100:400);
}

function changeBet(val){
  bet+=val;
  if(bet<10) bet=10;
  updateUI();
}

function toggleTurbo(){
  turbo=!turbo;
  alert("Turbo: "+(turbo?"ON":"OFF"));
}

function showBigWin(){
  bigwinEl.style.display="block";
  setTimeout(()=>bigwinEl.style.display="none",1500);
}

function dropCoins(){
  for(let i=0;i<20;i++){
    const coin=document.createElement("div");
    coin.classList.add("coin");
    coin.innerText="ðŸª™";
    coin.style.left=Math.random()*100+"vw";
    document.body.appendChild(coin);
    setTimeout(()=>coin.remove(),2000);
  }
}

createGrid();
updateUI();
</script>

</body>
</html>
