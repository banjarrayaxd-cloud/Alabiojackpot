<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mahjong Style Slot Ultra</title>
<style>
body{
  margin:0;
  background:radial-gradient(circle at top,#16222A,#0F2027);
  font-family:Arial;
  color:white;
  text-align:center;
  overflow:hidden;
}

h1{margin:10px;}

.topbar{
  display:flex;
  justify-content:space-around;
  padding:10px;
  font-size:16px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(5,75px);
  grid-template-rows:repeat(4,75px);
  gap:6px;
  justify-content:center;
  margin:20px auto;
}

.cell{
  background:linear-gradient(gold,#b8860b);
  color:black;
  font-size:26px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:12px;
  transition:0.3s;
  animation:drop 0.3s ease;
}

@keyframes drop{
  from{transform:translateY(-30px);opacity:0;}
  to{transform:translateY(0);opacity:1;}
}

.win{
  background:lime;
  transform:scale(1.2);
}

.scatter{
  background:orange !important;
}

.controls{
  margin:10px;
}

button{
  padding:8px 15px;
  font-size:14px;
  border:none;
  border-radius:6px;
  margin:5px;
  cursor:pointer;
}

.spin{
  background:red;
  color:white;
  font-size:18px;
}

.bigwin{
  position:fixed;
  top:40%;
  left:50%;
  transform:translate(-50%,-50%);
  font-size:40px;
  font-weight:bold;
  color:gold;
  display:none;
  animation:zoom 0.6s ease infinite alternate;
}

@keyframes zoom{
  from{transform:translate(-50%,-50%) scale(1);}
  to{transform:translate(-50%,-50%) scale(1.2);}
}
</style>
</head>
<body>

<h1>ðŸŽ° Mahjong Style Slot Ultra (Demo)</h1>

<div class="topbar">
  <div>Saldo: <span id="balance">1000</span></div>
  <div>Bet: <span id="bet">10</span></div>
  <div>Multi: x<span id="multi">1</span></div>
  <div>Free: <span id="free">0</span></div>
</div>

<div class="grid" id="grid"></div>

<div class="controls">
  <button onclick="changeBet(-10)">- Bet</button>
  <button onclick="changeBet(10)">+ Bet</button>
  <button onclick="toggleTurbo()">Turbo</button>
  <button class="spin" onclick="spin()">SPIN</button>
</div>

<div class="bigwin" id="bigwin">ðŸ”¥ BIG WIN ðŸ”¥</div>

<script>
const symbols=["ðŸ€„","ðŸ€…","ðŸ€†","ðŸ€‡","ðŸ€ˆ","ðŸ€‰"];
const scatterSymbol="ðŸ’Ž";

let balance=1000;
let bet=10;
let multiplier=1;
let freeSpin=0;
let turbo=false;

const gridEl=document.getElementById("grid");
const balanceEl=document.getElementById("balance");
const betEl=document.getElementById("bet");
const multiEl=document.getElementById("multi");
const freeEl=document.getElementById("free");
const bigwinEl=document.getElementById("bigwin");

function updateUI(){
  balanceEl.innerText=balance;
  betEl.innerText=bet;
  multiEl.innerText=multiplier;
  freeEl.innerText=freeSpin;
}

function randomSymbol(){
  if(Math.random()<0.1) return scatterSymbol;
  return symbols[Math.floor(Math.random()*symbols.length)];
}

function createGrid(){
  gridEl.innerHTML="";
  for(let i=0;i<20;i++){
    const div=document.createElement("div");
    div.classList.add("cell");
    div.innerText=randomSymbol();
    gridEl.appendChild(div);
  }
}

function spin(){
  if(balance<bet && freeSpin==0) return alert("Saldo habis!");

  if(freeSpin>0){ freeSpin--; }
  else{ balance-=bet; }

  multiplier=1;
  createGrid();

  setTimeout(checkResult, turbo?100:400);
  updateUI();
}

function checkResult(){
  const cells=document.querySelectorAll(".cell");
  let map={}, scatterCount=0;
  let totalWin=0;

  cells.forEach(cell=>{
    map[cell.innerText]=(map[cell.innerText]||0)+1;
    if(cell.innerText==scatterSymbol){
      scatterCount++;
      cell.classList.add("scatter");
    }
  });

  if(scatterCount>=3){
    freeSpin+=5;
  }

  for(let key in map){
    if(key!=scatterSymbol && map[key]>=4){
      cells.forEach(cell=>{
        if(cell.innerText==key){
          cell.classList.add("win");
        }
      });
      let winAmount=bet*multiplier*(map[key]/4);
      totalWin+=winAmount;
      multiplier++;
    }
  }

  if(totalWin>0){
    balance+=Math.floor(totalWin);

    if(totalWin>bet*5){
      bigwinEl.style.display="block";
      navigator.vibrate?.(300);
      setTimeout(()=>{bigwinEl.style.display="none";},1500);
    }

    updateUI();
    setTimeout(cascade, turbo?100:500);
  }
}

function cascade(){
  const cells=document.querySelectorAll(".cell");
  cells.forEach(cell=>{
    if(cell.classList.contains("win")){
      cell.classList.remove("win");
      cell.innerText=randomSymbol();
    }
  });
  setTimeout(checkResult, turbo?100:400);
}

function changeBet(val){
  bet+=val;
  if(bet<10) bet=10;
  updateUI();
}

function toggleTurbo(){
  turbo=!turbo;
  alert("Turbo: "+(turbo?"ON":"OFF"));
}

createGrid();
updateUI();
</script>

</body>
</html>
